<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fits Latent Class Models for Data Containing Group Variable and Covariates — glca • glca</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fits Latent Class Models for Data Containing Group Variable and Covariates — glca"><meta property="og:description" content="Function for fitting latent class models with multiple groups, which may or may not include latent class structure for group variable."><meta property="og:image" content="http://kim0sun.github.io/glca/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glca</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/glca.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/model-description.html">Model description for glca</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kim0sun/glca/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits Latent Class Models for Data Containing Group Variable and Covariates</h1>
    <small class="dont-index">Source: <a href="https://github.com/kim0sun/glca/blob/HEAD/R/glca.R" class="external-link"><code>R/glca.R</code></a></small>
    <div class="hidden name"><code>glca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function for fitting latent class models with multiple groups, which may or may not include latent class structure for group variable.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glca</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nclass <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  ncluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  std.err <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  measure.inv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  coeff.inv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  init.param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.init <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  decreasing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  testiter <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>a formula for specifying manifest items and covariates using the "<code>item</code>" function.</p></dd>


<dt>group</dt>
<dd><p>an optional vector specifying a group of observations. Given group variable, group covariates can be incorporated.</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the manifest item, covariates and group variable.</p></dd>


<dt>nclass</dt>
<dd><p>number of level-1 (individual-level) latent classes.</p></dd>


<dt>ncluster</dt>
<dd><p>number of level-2 (group-level) latent classes. When <code>group</code> and <code>ncluster</code> (&gt;1) are given the multilevel latent class models will be fitted.</p></dd>


<dt>std.err</dt>
<dd><p>a logical value for whether calculating standard errors for estimates.</p></dd>


<dt>measure.inv</dt>
<dd><p>a logical value of the measurement invariance assumption across groups.</p></dd>


<dt>coeff.inv</dt>
<dd><p>a logical value of the coefficient invariance assumption across groups (random intercept model).</p></dd>


<dt>init.param</dt>
<dd><p>A set of model parameters to be used as the user-defined initial values for the EM algorithm. It should be <code>list</code> with the named parameters and have same structure of <code>param</code> of the <code>glca</code> output. In default, initial parameters are randomly generated.</p></dd>


<dt>n.init</dt>
<dd><p>number of randomly generated initial parameter sets to be used for avoiding the problem of local maxima.</p></dd>


<dt>decreasing</dt>
<dd><p>a logical value for whether reordering the parameters by descending order responding probability for first-category of first manifest item.</p></dd>


<dt>testiter</dt>
<dd><p>number of iterations in the EM algorithm for each initial parameter set. The initial parameter set that provides the largest log-likelihood will be selected for estimating the model.</p></dd>


<dt>maxiter</dt>
<dd><p>maximum number of iterations for the EM algorithm.</p></dd>


<dt>eps</dt>
<dd><p>a convergence tolerance value. When the largest absolute difference between former estimates and current estimates is less than <code>eps</code>, the algorithm will stop updating and consider the convergence to be reached.</p></dd>


<dt>na.rm</dt>
<dd><p>a logical value for deleting the lines that have at least one missing manifest item. If <code>na.rm = FALSE</code>, MAR procedure will be conducted.</p></dd>


<dt>seed</dt>
<dd><p>In default, the set of initial parameters is drawn randomly. As the same value for seed guarantees the same initial parameters to be drawn, this argument can be used for reproducibility of estimation results.</p></dd>


<dt>verbose</dt>
<dd><p>a logical value indicating whether <code>glca</code> should print the estimation procedure onto the screen.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>glca</code> returns an object of class "<code>glca</code>".</p>


<p>The function <code>summary</code> prints estimates for parameters and <code>glca.gof</code> function gives goodness of fit measures for the model.</p>


<p>An object of class "<code>glca</code>" is a list containing the following components:</p>
<dl><dt>call</dt>
<dd><p>the matched call.</p></dd>

<dt>terms</dt>
<dd><p>the <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></code> object used.</p></dd>

<dt>model</dt>
<dd><p>a <code>list</code> of model description.</p></dd>

<dt>var.names</dt>
<dd><p>a <code>list</code> of names of data.</p></dd>

<dt>datalist</dt>
<dd><p>a <code>list</code> of data used for fitting.</p></dd>

<dt>param</dt>
<dd><p>a <code>list</code> of parameter estimates.</p></dd>

<dt>std.err</dt>
<dd><p>a <code>list</code> of standard errors for estimates.</p></dd>

<dt>coefficient</dt>
<dd><p>a <code>list</code> of logistic regression coefficients for prevalence of level-1 class.</p></dd>

<dt>posterior</dt>
<dd><p>a <code>data.frame</code> or a <code>list</code> of posterior probablities of each individaul for latent classes and each group for latent clusters.</p></dd>

<dt>gof</dt>
<dd><p>a <code>list</code> of goodness of fit measures.</p></dd>

<dt>convergence</dt>
<dd><p>a <code>list</code> containing information about convergence.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>glca</code> is the function for implementing LCA consist of two-type latent categorical variables (i.e., level-1 and level-2 latent class). The level-1 (individual-level) latent class is identified by the association among the individuals' responses to multiple manifest items, but level-2 (group-level) latent class is categorized by the prevalence of level-1 latent class for group variable. The function <code>glca</code> can handle two types of covariates: level-1 and level-2 covariates. If covariates vary across individuals, they are considered as level-1 covariates. When <code>group</code> and <code>ncluster</code> (&gt;1) are given, covariates which are varying across groups are considered as level-2 covariates. Both types of covariates have effect on level-1 class prevalence.</p>
<p>The formula should consist of an <code>~</code> operator between two sides. Manifest items should be indicated in LHS of formula using <code>item</code> function and covariates should be specified in RHS of formula. For example, <br><code>item(y1, y2, y3) ~ 1</code><br><code>item(y1, y2, y3) ~ x1 + x2</code><br>
where the first fomula indicates LCA with three manifest variables (<code>y1</code>, <code>y2</code>, and <code>y3</code>) and no covariate, and the second formula includes two covariates (<code>x1</code> and <code>x2</code>). Two types of covariates (i.e., level-1 and level-2 covariates) will be automatically detected by <code>glca</code>.</p>
<p>The estimated parameters in <code>glca</code> are <code>rho</code>, <code>gamma</code>, <code>delta</code>, and <code>beta</code>. The set of item response probabilities for each level-1 class is <code>rho</code>. The sets of prevalences for level-1 and level-2 class are <code>gamma</code> and <code>delta</code>, respectively. The prevalence for level-1 class (i.e., <code>gamma</code>) can be modeled as logistic regression using level-1 and/or level-2 covariates. The set of logistic regression coefficients is <code>beta</code> in <code>glca</code> output.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Vermunt, J.K. (2003) Multilevel latent class models. <em>Sociological Methodology</em>, <b>33</b>, 213--239. <a href="https://doi.org/10.1111/j.0081-1750.2003.t01-1-00131.x" class="external-link">doi:10.1111/j.0081-1750.2003.t01-1-00131.x</a></p>
<p>Collins, L.M. and Lanza, S.T. (2009) <em>Latent Class and Latent Transition Analysis: With Applications in the Social, Behavioral, and Health Sciences</em>. John Wiley &amp; Sons Inc.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gss08.html">gss08</a></code> <code><a href="nyts18.html">nyts18</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Example 1. GSS dataset</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gss08"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCA</span></span></span>
<span class="r-in"><span><span class="va">lca</span> <span class="op">=</span> <span class="fu">glca</span><span class="op">(</span><span class="fu"><a href="item.html">item</a></span><span class="op">(</span><span class="va">DEFECT</span>, <span class="va">HLTH</span>, <span class="va">RAPE</span>, <span class="va">POOR</span>, <span class="va">SINGLE</span>, <span class="va">NOMORE</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">gss08</span>, nclass <span class="op">=</span> <span class="fl">3</span>, n.init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deleted observation(s) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 observation(s) for missing all manifest items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing at least 1 covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Latent class analysis Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> . 123 iteration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged at 123 iteration (loglik :-687.4486)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1, data = gss08, nclass = 3, n.init = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Categories for manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y = 1 Y = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DEFECT   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLTH     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RAPE     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> POOR     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SINGLE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOMORE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model : Latent class analysis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent classes : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations : 352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters : 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood : -687.4486 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      G-squared : 29.82695 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            AIC : 1414.897 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            BIC : 1492.17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal prevalences for latent classes :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 Class 2 Class 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.34467 0.19138 0.46396 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 1) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.8275 0.9453 0.7960 0.0638 0.0390 0.1344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.0466 0.3684 0.0949 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 1.0000 1.0000 1.0000 0.9813 0.9284 0.9657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 2) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.1725 0.0547 0.2040 0.9362 0.9610 0.8656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.9534 0.6316 0.9051 1.0000 1.0000 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.0000 0.0000 0.0000 0.0187 0.0716 0.0343</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LCA with covariate(s)</span></span></span>
<span class="r-in"><span><span class="va">lcr</span> <span class="op">=</span> <span class="fu">glca</span><span class="op">(</span><span class="fu"><a href="item.html">item</a></span><span class="op">(</span><span class="va">DEFECT</span>, <span class="va">HLTH</span>, <span class="va">RAPE</span>, <span class="va">POOR</span>, <span class="va">SINGLE</span>, <span class="va">NOMORE</span><span class="op">)</span> <span class="op">~</span> <span class="va">AGE</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="va">gss08</span>, nclass <span class="op">=</span> <span class="fl">3</span>, n.init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates (Level 1) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AGE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deleted observation(s) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 observation(s) for missing all manifest items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing at least 1 covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Latent class analysis Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> . 117 iteration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged at 117 iteration (loglik :-686.4118)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lcr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     AGE, data = gss08, nclass = 3, n.init = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates (Level 1) : AGE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Categories for manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y = 1 Y = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DEFECT   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLTH     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RAPE     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> POOR     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SINGLE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOMORE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model : Latent class analysis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent classes : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations : 352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters : 22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood : -686.4118 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      G-squared : 589.4148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            AIC : 1416.824 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            BIC : 1501.824 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal prevalences for latent classes :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 Class 2 Class 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18809 0.46397 0.34794 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Logistic regression coefficients :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1/3 Class 2/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    0.1210    0.6065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGE           -0.0156   -0.0066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 1) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.0239 0.3719 0.1016 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 1.0000 1.0000 1.0000 0.9813 0.9283 0.9656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.8338 0.9399 0.7852 0.0628 0.0386 0.1330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 2) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.9761 0.6281 0.8984 1.0000 1.0000 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.0000 0.0000 0.0000 0.0187 0.0717 0.0344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.1662 0.0601 0.2148 0.9372 0.9614 0.8670</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lcr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    1.12860     0.12098     0.51570    0.235     0.815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGE            0.98453    -0.01559     0.01077   -1.447     0.149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   1.834068    0.606537    0.364407    1.664     0.097 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGE           0.993465   -0.006557    0.007060   -0.929     0.354  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple-group LCA (MGLCA)</span></span></span>
<span class="r-in"><span><span class="va">mglca</span> <span class="op">=</span> <span class="fu">glca</span><span class="op">(</span><span class="fu"><a href="item.html">item</a></span><span class="op">(</span><span class="va">DEFECT</span>, <span class="va">HLTH</span>, <span class="va">RAPE</span>, <span class="va">POOR</span>, <span class="va">SINGLE</span>, <span class="va">NOMORE</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>             group <span class="op">=</span> <span class="va">DEGREE</span>, data <span class="op">=</span> <span class="va">gss08</span>, nclass <span class="op">=</span> <span class="fl">3</span>, n.init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : DEGREE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deleted observation(s) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 observation(s) for missing all manifest items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing at least 1 covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple-group latent class analysis Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  91 iteration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged at 91 iteration (loglik :-672.4138)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mglca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1, group = DEGREE, data = gss08, nclass = 3, n.init = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : DEGREE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Categories for manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y = 1 Y = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DEFECT   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLTH     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RAPE     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> POOR     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SINGLE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOMORE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model : Multiple-group latent class analysis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent classes : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of groups : 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations : 352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters : 26 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood : -672.4138 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      G-squared : 87.85135 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            AIC : 1396.828 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            BIC : 1497.282 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal prevalences for latent classes :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 Class 2 Class 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.34468 0.46148 0.19384 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class prevalences by group :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1 Class 2 Class 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= HS       0.51954 0.16850 0.31196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HIGH SCHOOL 0.34862 0.44393 0.20745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COLLEGE     0.29846 0.55348 0.14806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRADUATE    0.20439 0.71186 0.08375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 1) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.8318 0.9470 0.7999 0.0690 0.0433 0.1389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 1.0000 1.0000 1.0000 0.9835 0.9309 0.9681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.0507 0.3724 0.0995 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 2) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.1682 0.0530 0.2001 0.9310 0.9567 0.8611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.0000 0.0000 0.0000 0.0165 0.0691 0.0319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.9493 0.6276 0.9005 1.0000 1.0000 1.0000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple-group LCA with covariate(s) (MGLCR)</span></span></span>
<span class="r-in"><span><span class="va">mglcr</span> <span class="op">=</span> <span class="fu">glca</span><span class="op">(</span><span class="fu"><a href="item.html">item</a></span><span class="op">(</span><span class="va">DEFECT</span>, <span class="va">HLTH</span>, <span class="va">RAPE</span>, <span class="va">POOR</span>, <span class="va">SINGLE</span>, <span class="va">NOMORE</span><span class="op">)</span> <span class="op">~</span> <span class="va">SEX</span>,</span></span>
<span class="r-in"><span>             group <span class="op">=</span> <span class="va">DEGREE</span>, data <span class="op">=</span> <span class="va">gss08</span>, nclass <span class="op">=</span> <span class="fl">3</span>, n.init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : DEGREE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates (Level 1) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SEX </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deleted observation(s) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 observation(s) for missing all manifest items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing at least 1 covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple-group latent class analysis Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  98 iteration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged at 98 iteration (loglik :-666.7097)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mglcr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glca(formula = item(DEFECT, HLTH, RAPE, POOR, SINGLE, NOMORE) ~ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SEX, group = DEGREE, data = gss08, nclass = 3, n.init = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items : DEFECT HLTH RAPE POOR SINGLE NOMORE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : DEGREE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates (Level 1) : SEX </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Categories for manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y = 1 Y = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DEFECT   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLTH     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RAPE     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> POOR     YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SINGLE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOMORE   YES    NO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model : Multiple-group latent class analysis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent classes : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of groups : 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations : 352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters : 28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood : -666.7097 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      G-squared : 149.9656 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            AIC : 1389.419 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            BIC : 1497.601 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal prevalences for latent classes :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 Class 2 Class 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.33996 0.19860 0.46144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class prevalences by group :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1 Class 2 Class 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;= HS       0.51010 0.32143 0.16848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HIGH SCHOOL 0.34339 0.21275 0.44386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COLLEGE     0.29616 0.15036 0.55347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRADUATE    0.20237 0.08580 0.71183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Logistic regression coefficients :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group : &lt;= HS </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1/3 Class 2/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    1.0634   -0.0811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFEMALE      0.0834    1.1140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group : HIGH SCHOOL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1/3 Class 2/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   -0.2979    -1.424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFEMALE      0.0834     1.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group : COLLEGE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1/3 Class 2/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   -0.6686   -2.0173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFEMALE      0.0834    1.1140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group : GRADUATE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Class 1/3 Class 2/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   -1.2872   -2.6492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFEMALE      0.0834    1.1140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 1) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.8342 0.9488 0.8086 0.0700 0.0440 0.1409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.0649 0.3825 0.0989 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 1.0000 1.0000 1.0000 0.9836 0.9309 0.9682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 2) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DEFECT   HLTH   RAPE   POOR SINGLE NOMORE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.1658 0.0512 0.1914 0.9300 0.9560 0.8591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.9351 0.6175 0.9011 1.0000 1.0000 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.0000 0.0000 0.0000 0.0164 0.0691 0.0318</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mglcr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFEMALE    1.08693     0.08335     0.06815    1.223     0.222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFEMALE    3.04651     1.11400     0.09062    12.29    &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Example 2. NYTS dataset</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nyts18"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Multilevel LCA (MLCA)</span></span></span>
<span class="r-in"><span><span class="va">mlca</span> <span class="op">=</span> <span class="fu">glca</span><span class="op">(</span><span class="fu"><a href="item.html">item</a></span><span class="op">(</span><span class="va">ECIGT</span>, <span class="va">ECIGAR</span>, <span class="va">ESLT</span>, <span class="va">EELCIGT</span>, <span class="va">EHOOKAH</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            group <span class="op">=</span> <span class="va">SCH_ID</span>, data <span class="op">=</span> <span class="va">nyts18</span>, nclass <span class="op">=</span> <span class="fl">3</span>, ncluster <span class="op">=</span> <span class="fl">2</span>, n.init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ECIGT ECIGAR ESLT EELCIGT EHOOKAH </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : SCH_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deleted observation(s) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing all manifest items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing at least 1 covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonparametric multilevel latent class analysis Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .. 230 iteration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged at 230 iteration (loglik :-1955.487)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mlca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glca(formula = item(ECIGT, ECIGAR, ESLT, EELCIGT, EHOOKAH) ~ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1, group = SCH_ID, data = nyts18, nclass = 3, ncluster = 2, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n.init = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items : ECIGT ECIGAR ESLT EELCIGT EHOOKAH </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : SCH_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Categories for manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Y = 1 Y = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECIGT     Yes    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECIGAR    Yes    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ESLT      Yes    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EELCIGT   Yes    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EHOOKAH   Yes    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model : Nonparametric multilevel latent class analysis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent classes : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of latent clusters : 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of groups : 45 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations : 1734 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters : 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood : -1955.487 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      G-squared : 768.5035 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            AIC : 3950.973 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            BIC : 4060.137 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal prevalences for latent classes :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 Class 2 Class 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.76960 0.05961 0.17079 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal prevalences for latent clusters :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cluster 1 Cluster 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.6207    0.3793 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class prevalences by cluster :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Class 1 Class 2 Class 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cluster 1 0.92994 0.00876 0.06130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cluster 2 0.51176 0.14137 0.34687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 1) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ECIGT ECIGAR   ESLT EELCIGT EHOOKAH</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.0062 0.0043 0.0088  0.0413  0.0057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.9112 0.9750 0.5651  0.9778  0.5363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.3488 0.2006 0.1236  0.7783  0.0443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item-response probabilities (Y = 2) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ECIGT ECIGAR   ESLT EELCIGT EHOOKAH</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 0.9938 0.9957 0.9912  0.9587  0.9943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 0.0888 0.0250 0.4349  0.0222  0.4637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 3 0.6512 0.7994 0.8764  0.2217  0.9557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MLCA with covariate(s) (MLCR)</span></span></span>
<span class="r-in"><span><span class="co"># (SEX: level-1 covariate, SCH_LEV: level-2 covariate)</span></span></span>
<span class="r-in"><span><span class="va">mlcr</span> <span class="op">=</span> <span class="fu">glca</span><span class="op">(</span><span class="fu"><a href="item.html">item</a></span><span class="op">(</span><span class="va">ECIGT</span>, <span class="va">ECIGAR</span>, <span class="va">ESLT</span>, <span class="va">EELCIGT</span>, <span class="va">EHOOKAH</span><span class="op">)</span> <span class="op">~</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">SCH_LEV</span>,</span></span>
<span class="r-in"><span>            group <span class="op">=</span> <span class="va">SCH_ID</span>, data <span class="op">=</span> <span class="va">nyts18</span>, nclass <span class="op">=</span> <span class="fl">3</span>, ncluster <span class="op">=</span> <span class="fl">2</span>, n.init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manifest items :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ECIGT ECIGAR ESLT EELCIGT EHOOKAH </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable : SCH_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates (Level 2) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SCH_LEV </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates (Level 1) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SEX </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deleted observation(s) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing all manifest items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 observation(s) for missing at least 1 covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonparametric multilevel latent class analysis Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .. 240 iteration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged at 240 iteration (loglik :-1921.19)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mlcr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level 1 Coefficients :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFemale     1.6859      0.5223      0.2098    2.489    0.0129 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXFemale     0.8514     -0.1609      0.1951   -0.825      0.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level 2 Coefficients :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 1 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCH_LEVMiddle School     0.1318     -2.0264      1.5545   -1.304     0.193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class 2 / 3 :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCH_LEVMiddle School    19.8234      2.9869      0.4142    7.212  8.27e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Youngsun Kim, Hwan Chung.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

